parameters:
  pythonVersion: ''
  artifactName: ''
  workerPath: ''

steps:
- task: UsePythonVersion@0
  inputs:
    versionSpec: ${{ parameters.pythonVersion }}
    addToPath: true
- task: ShellScript@2
  inputs:
    disableAutoCwd: true
    scriptPath: 'pack/scripts/mac_arm64_deps.sh'
- task: CopyFiles@2
  inputs:
    contents: |
      ${{ parameters.workerPath }}
    targetFolder: '$(Build.ArtifactStagingDirectory)'
    flattenFolders: true
- task: CopyFiles@2
  inputs:
    sourceFolder: '$(Build.SourcesDirectory)/deps'
    contents: |
      **
      !grpc_tools/**/*
      !grpcio_tools*/*
      !_manifest/*
      !bcde_output/*
      !build/*
      !docs/*
      !pack/*
      !python/*
      !tests/*
      !Experiment_PipReport_*
      !GovCompDisc_Log_*
      !GovCompDisc_Manifest_*
      !GovCompDisc_Metadata_*
      !ScanTelemetry_*
    targetFolder: '$(Build.ArtifactStagingDirectory)'
